(function(a){SABAI.GoogleMaps=SABAI.GoogleMaps||{};SABAI.GoogleMaps.maps=SABAI.GoogleMaps.maps||{};SABAI.GoogleMaps.map=SABAI.GoogleMaps.map||function(v,H,K,c,j,z){var p,o,e=H.length,s,J,D,b,d,l=j.infobox_width||250,f=new InfoBox({boxClass:"sabai-googlemaps-infobox sabai-box-shadow",disableAutoPan:false,closeBoxMargin:0,closeBoxURL:'https://www.google.com/intl/en_us/mapfiles/close.gif',infoBoxClearance:new google.maps.Size(30,30),pixelOffset:new google.maps.Size(-1*l/2,-55),alignBottom:true,boxStyle:{width:l+"px"}}),F='<div class="sabai-googlemaps-infobox-arrow" style="left:'+((l/2)-8)+'px"></div>',G,r,n=[],I;p=a(v);if(!p.length){return}if(!K){K=e?new google.maps.LatLng(H[0].lat,H[0].lng):new google.maps.LatLng(j.default_lat||40.69847,j.default_lng||-73.95144);if(e>1){r=new google.maps.LatLngBounds()}}else{K=new google.maps.LatLng(K[0],K[1]);if(j.force_fit_bounds!=false&&e>0){r=new google.maps.LatLngBounds()}}for(I in google.maps.MapTypeId){n.push(google.maps.MapTypeId[I])}n.push("osm");o=new google.maps.Map(p.get(0),{mapTypeControl:true,mapTypeId:a.inArray(p.data("map-type"),n)!==-1?p.data("map-type"):google.maps.MapTypeId.ROADMAP,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU,mapTypeIds:n},panControl:false,zoom:c,center:K,scrollwheel:j.scrollwheel!=false,styles:SABAI.GoogleMaps.styles||[{featureType:"poi",stylers:[{visibility:"off"}]}]});o.mapTypes.set("osm",new google.maps.ImageMapType({getTileUrl:function(L,i){return"//tile.openstreetmap.org/"+i+"/"+L.x+"/"+L.y+".png"},tileSize:new google.maps.Size(256,256),isPng:true,maxZoom:19,minZoom:0,name:"OSM"}));if(e>0){if(j.marker_clusters!=false){var w={maxZoom:15};if(j.marker_cluster_imgurl){w.imagePath=j.marker_cluster_imgurl+"/m"}b=new MarkerClusterer(o,[],w)}for(G=0;G<e;G++){D=new google.maps.LatLng(H[G].lat,H[G].lng);s=new google.maps.Marker({position:D});if(H[G].icon||j.icon){if(!d){d={};if(parseInt(j.marker_width)&&parseInt(j.marker_height)){d.size=d.scaledSize=new google.maps.Size(parseInt(j.marker_width),parseInt(j.marker_height))}}d.url=H[G].icon||j.icon;s.setIcon(d)}if(r){r.extend(D);if(j.force_fit_bounds!=false){r.extend(new google.maps.LatLng(K.lat()*2-H[G].lat,K.lng()*2-H[G].lng))}}google.maps.event.addListener(s,j.marker_event||"click",(function(L,M){return function(i){if(J&&J.get("id")===L.get("id")){return}o.panTo(L.getPosition());if(b&&i.triggered){o.setZoom(16);b.repaint()}if(J){J.setAnimation(null)}if((!i.triggered||i.trigger_infobox)&&H[M].content){f.setContent(F+H[M].content);f.open(o,L);J=L}else{L.setAnimation(google.maps.Animation.BOUNCE);setTimeout(function(){L.setAnimation(null)},1400)}}})(s,G));if(H[G].trigger){var E=a(H[G].trigger);if(E.length){var B=H[G].triggerEvent||"mouseover";E[B]((function(L,N,M,P,O){return function(){if(P==="change"&&M.val()!=N){if(M.val()===""){f.close()}return}google.maps.event.trigger(L,j.marker_event||"click",{triggered:true,trigger_infobox:O});return false}})(s,G,E,B,H[G].trigger_infobox))}}s.set("id",G);if(b){b.addMarker(s)}else{s.setMap(o)}if(j.default_marker!==undefined&&j.default_marker===G){setTimeout((function(i){return function(){google.maps.event.trigger(i,j.marker_event||"click",{init:true})}}(s)),1500)}}if(j.enable_directions){var A=a(j.enable_directions);if(!A.length){return}var C=A.find(".sabai-googlemaps-directions-trigger");if(!C.length){return}var h,u=A.find(".sabai-googlemaps-directions-panel"),y=new google.maps.DirectionsService(),k,g;A.find(".sabai-googlemaps-directions-panel").hide().end().find(".sabai-googlemaps-directions-input").val("").end().find(".sabai-googlemaps-directions-destination").val(0);C.click(function(N){N.preventDefault();var M=a(this),L=A.find(".sabai-googlemaps-directions-destination").val();if(L===""||!H[L]){return}var i=A.find(".sabai-googlemaps-directions-input").val();if(!i){return}f.close();M.addClass("sabai-disabled");h=H[L];g={origin:i,destination:new google.maps.LatLng(h.lat,h.lng),travelMode:google.maps.TravelMode[M.data("travel-mode")||"DRIVING"]};u.html("").hide();if(k!=null){k.setMap(null);k=null}k=new google.maps.DirectionsRenderer({map:o,draggable:true,panel:u.get(0)});y.route(g,function(P,O){if(O==google.maps.DirectionsStatus.OK){k.setDirections(P);SABAI.scrollTo(v);u.show().find("img.adp-marker").hide()}else{alert("No directions found")}M.removeClass("sabai-disabled")})})}google.maps.event.addListener(f,"closeclick",function(){J=null});google.maps.event.addListener(f,"clusteringbegin",function(){f.close();J=null});if(r){o.fitBounds(r)}}if(j.circle&&j.circle.center&&parseInt(j.circle.draw)){var m=new google.maps.Circle({strokeColor:j.circle.stroke_color||"#99f",strokeOpacity:0.8,strokeWeight:1,fillColor:j.circle.fill_color||"#99f",fillOpacity:0.3,map:o,center:new google.maps.LatLng(j.circle.center[0],j.circle.center[1]),radius:j.circle.is_mile?j.circle.radius*1609.344:j.circle.radius*1000});if(!r){o.fitBounds(m.getBounds())}}if(z){var q=a(j.update_trigger||v+"-update");if(q.length){var x,t=function(){if(!q.prop("checked")){return}z.call(o,o.getCenter(),o.getBounds(),o.getZoom())};google.maps.event.addListener(o,"dragend",function(){x=setTimeout(t,1000)});google.maps.event.addListener(o,"mousedown",function(){if(x){clearTimeout(x)}});if(a.cookie){q.prop("checked",a.cookie("sabai_googlemaps_map_update")).click(function(){if(a(this).prop("checked")){a.cookie("sabai_googlemaps_map_update",true,{expires:7,path:SABAI.path,domain:SABAI.domain})}else{a.removeCookie("sabai_googlemaps_map_update")}})}}}SABAI.GoogleMaps.maps[v]=o;return o};SABAI.Directory=SABAI.Directory||{};SABAI.Directory.googleMap=function(d,h,g,b,f,e,c){SABAI.GoogleMaps.map(d,h,b,f,e,c,g)}})(jQuery);
